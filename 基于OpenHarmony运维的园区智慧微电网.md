# 一、背景介绍
在2030年之前实现碳达峰，在2060年之前达到碳中和，是我国必须完成的科技目标之一。2015年7月，国家能源局对外发布《关于推进新能源微电网示范项目建设的指导意见》，标志着在在我国，微电网项目建设被正式提升至国家层面。在政策的大力支持下，微电网的布局建设将加快。未来我国微电网行业有四个发展方向，能效为先，拒绝浪费、热电联产，多能互补、风光互补，清洁电力、以及必备储能，保障安全。

随着我国社会进程的不断加快，如何恢复到绿水青山成为眼前的重要问题，为此中国政府提出了“双碳”政策，智慧微电网主要面向基础的生活生产园区提供智慧微网规划设计和系统运维，并向远离电网的偏远地区，如边防哨所、农村电网尚未覆盖到的地区提供应急供电，解决用户用电难、用电贵的问题，积极实现节能减排并有效针对生产产量不协调的问题进行了合理调配，满足日常生活供电和生产用电需求，实现全方位的开源节流与节能减排，为实现碳中和与碳中和作出贡献。
# 二、社会痛点
（1）风力发电机的适用性狭隘，产生噪音大，对于周边环境影响大，无法控制规模，小型园区和居民生活区不适用。

（2）大规模的光伏太阳能板占地范围大，常年暴露在屋顶无法进行自适应追光及控制，光能利用率低，发电效率低。

（3）园区缺乏配套运维系统，大型运维系统价格高昂，不适配不同园区针对性强，不利于大范围推广，导致多数生活及工业园区缺少运维系统，发电都是“两眼抓瞎”。

（4）缺少用电预测及分析，无法根据不同生活及工业习性，调整发电策略，降低能源浪费，提高设备的使用寿命。
# 三、项目架构
本产品向生产和生活园区提供智慧微网规划设计和系统运维，并向远离电网的偏远地区提供应急供电，解决用户用电难、用电贵、节能减排和生产产量不协调的问题，满足日常生活供电和生产用电需求，通过提供一站式园区级电网技术服务和个体零售租赁等方式获取收益，以分布式智慧微网设计+云上运维系统+用电预测及规划作为核心竞争力，支持项目的可持续发展。

项目核心优势：  
（1）智慧微网设计，利用吉村折纸原理实现发电终端的高折叠比，基于集群效应实现微风发电，获取最大的发电效率，在保证小型便携效果的同时，极大程度提高设备的适用性。

（2）云上运维系统设计，基于数字化、可视化设计思想实现设备全生命周期监测、数据可视化，并且通过对低代码平台开发，快速搭建各大监控平台，提高运维系统的适配性、多样性及全面性，适应用户的多种需求

（3）长短期发电预测及规划，通过长短期发电量预测，为用户量身定制用电规划，减少能源损耗，提高发电效率，降低设备运维成本。

（4）规模部署灵活+适用性强，可根据园区规模大小灵活部署，也可进行居民园区分散部署，采用大规模分散，微主体聚合的新型智慧微电网概念适应绝大多数场地。  

![图3-1 项目架构](/images/image.1.png "图3-1 项目架构")  


# 四、开发环境
1.OpenHarmony 3.2 relase  
2.anaconda-py3.7-64  
3.pytorch1.5.1 -gpu+
# 五、设计思路
## 5.1 构建物理微电网
本产品利用吉村折纸原理进行设计，采用12块三角太阳能板和2块方形太阳能板进行厚板折叠，通过板型间隙设计、前背面柔性铰链连接，实现“口袋式折叠太阳能板设计”。  
![图5-1 基于吉村折纸设计的太阳能折叠](/images/image.2.jpg "图5-1 基于吉村折纸设计的太阳能折叠")  
## 5.2 构建数字微电网
我们使用OpenHarmony小熊派来将采集到的数据进行上报，通过MQTT协议和华为云IOT物联网平台进行连接，然后将传感器采集到的数据发送到华为云，再转发到OBS桶进行长期储存。最后进行数据调用，并将其反馈到前端展示页面，实现数字微电网的搭建。  
![图5-2 IoTDA平台](/images/image.3.png "图5-2 IoTDA平台") 
![图5-3 小熊派](/images/image.4.png "图5-3 小熊派") 
## 5.3 数字微电网向物理微电网
鸿蒙根据传感器数据进行FED(Comprehensive force with environmental data，受力与环境综合值)评估，若FED值超过阈值，会自动使采能前端折叠，实现自主保护；若未超过阈值，可根据FED值驱动折叠机构形变为最优的采能姿态，从而实现更高的风能捕获效率，提高发电量。  
![图5-4 自主研发的自适应捕风评估算法](/images/image.5.png "图5-4 自主研发的自适应捕风评估算法")  
## 5.4 大数据预测及构建
我们的电量预测数据集是在德国柏林工业大学的一个研究团队中找到的，通过查阅论文知道了这个数据集被很多做电量预测的高校和团队使用，具有很高的可使用性和准确性。可以用这个数据集来训练我们的发电量预测模型。

我们基于Pytorch来进行深度学习算法的开发，进行数据清晰和预处理后，我们把训练数据集放在写好的模型里进行训练，通过10000多轮训练后我们发现损失值已经减小到很理想的值（如下图所示）。那么之后就可以用这个模型来进行准确度检测。  
![图5-5 电量预测数据集及训练拟合程度](/images/image.6.png "图5-5 电量预测数据集及训练拟合程度")  ![图5-5 电量预测数据集及训练拟合程度](/images/image.7.png "图5-5 电量预测数据集及训练拟合程度")  

最后我们通过测试集来进行模型的准确度预测，准确率高达98%。通过画图可以看出准确值和预测值可以很好的拟合在一起。  
![图5-6 长短期电量预测](/images/image.8.png "图5-6 长短期电量预测") 
## 5.5 基于数据预测的用电规划
为了实现用户用电行为分析，我们通过K-means聚类算法来将用电行为类似的用户聚类在一起，来及时、准确地掌握用户用电行为特征，并为用户进行等级划分，将用电行为类似的用户进行聚合，根据不同类型的用户行为，自动调整微电网的输电效率。

我们通过获取用户的数据信息，将数据处理完后使用拐肘法进行聚类数量的选择，并定义相关的聚类模型，使用K-means聚类算法进行聚类，可以根据原来的10000条数据分为4类人群，可以根据这四类人群进行不同用电方案的规划。  
![图5-7 用电习惯及不同方案规划](/images/image.9.png "图5-7 用电习惯及不同方案规划")  ![图5-7 用电习惯及不同方案规划](/images/image.10.png "图5-7 用电习惯及不同方案规划")  

最后，我们将获得到的不同人群的用电习惯和预测电量进行拟合，规划不同的用电方案，降低多余的能源损耗，实现节能减排效果。
## 5.6 OpenHarmony开发
为了实现对发电设备的全生命周期监测，我们基于OpenHarmony开发了智能运维系统。可以通过手持设备来实时监测发电设备所处的环境，遇到恶劣天气时会进行告警提示，发电设备进行自主折叠来达到自我保护；同时还可以看到发电设备的预测电量和实际电量，帮助用户进行用电规划，提高能源的利用率。
# 六、实现原理
## 6.1 仿生式发电设备
（1）风光双效互补发电控制系统设计  
风光互补型混合发电；能源供应的持续性强；更高的风电转换效率。能利用风能和太阳能在气候、时间上的差异性和互补性，克服风和光照固有的间歇性和随机性缺陷。此外应用伯努利效应，通过对风管的多个特征量进行优化，使风电最低发电风速达2m/s，实际发电风速提高50%，提高风资源的利用效率，进一步增强能源供应的连续性。

太阳能发电前端完全折叠后仅占1个方形太阳能板大小，折叠比可达90.1%，并且可通过扩展内部三角结构和外层四边形边长，不断提高该折纸机构的折叠比，实现最大折叠比可达93.75%。  
![图6-1 通过不同配比实现更高折叠比](/images/image.11.1.png "图6-1 通过不同配比实现更高折叠比")  ![图6-1 通过不同配比实现更高折叠比](/images/image.11.2.png "图6-1 通过不同配比实现更高折叠比")  ![图6-1 通过不同配比实现更高折叠比](/images/image.11.3.png "图6-1 通过不同配比实现更高折叠比")  ![图6-1 通过不同配比实现更高折叠比](/images/image.11.4.png "图6-1 通过不同配比实现更高折叠比")    
![图6-2 太阳能板实物设计图](/images/image.12.jpg "图6-2 太阳能板实物设计图")  

该机构在通过平行四连杆机构连接最外层的四边形结构，通过电机对底部四边形进行驱动，完成该机构的自动折叠和展开的控制，并通过底座机构设计，传感器设计完成追光系统的设计。
![图6-3 太阳能机构设计](/images/image.13.jpg "图6-3 太阳能机构设计")  
（2）利用回收材料设计的集群式风力发电涡轮设计  
在风力发电机上，本产品采用独特的新型风力收集器，通过集群效应和啮合传动的原理，实现风力涡轮机的叶片的设计，并且通过回收的PLA废材进行溶解重塑，通过3D数字建模及打印，完成风力涡轮叶片的设计，该叶片通过20个涡轮一组，一排共四组的方式，带动四个发电机进行发电，通过大面积排布的方式，完成最大的风能收集。  
![图6-4 风力涡轮实物设计](/images/image.14.jpg "图6-4 风力涡轮实物设计")  

并且本产品全身采用可回收废料进行重新制作，减碳效益好，并且通过对每个涡轮进行不同颜色设计，拼装在一起后，可用于工业、居民园区的地标，作为独特设计，打造不一样的品牌效益。  
![图6-5 分布式智慧微网设计概念图](/images/image.15.png "图6-5 分布式智慧微网设计概念图")  
## 6.2 发电量预测模型构建
（1）算法选择  
在选择短期发电量预测算法时，我们通过查阅资料和学习发现BP神经网络能够以任意精度逼近任何非线性连续函数，符合我们使用环境参数进行电量预测的需求。同时，我们还需要通过历史数据进行长期电量预测。我们最初选择对具有序列特性数据非常有效的RNN，但由于RNN难以记住长时间信息。于是我们最终选择了LSTM，它的门结构可以对输入信息进行选择性的记录和遗忘，能够避免长期依赖问题。

（2）数据预处理  
我们在德国柏林工业大学寻找电量数据集，通过画图进行数据分析，然后进行数据挖掘确定了用来进行预测的关键特征值。并对数据进行异常值去除、空值填充等预处理，将杂乱数据处理成适合模型训练的数据。  
![图3-1 图6-6 数据集](/images/image.16.png "图6-6 数据集")  

（3）模型训练  
完成数据的预处理后，我们在华为云Model Arts平台实现算法的开发。我们使用通过LSTM构建深度学习模型，实现长短期电量预测功能。通过收集发电设备的历史运行数据，使用长短期记忆神经网络进行发电量预测。通过预测一周后的预发电量，为用户进行用电规划，提高能源的利用率。经过10000轮训练后，模型的损失值可以达到0.001。  
![图6-7 损失值](/images/image.17.png "图6-7 损失值")  
![图6-8 预测模型](/images/image.18.png "图6-8 预测模型")  
## 6.3 OpenHarmony开发
（1）项目创建  
创建新项目时，点击File按钮，在弹出的列表里点击New，然后创建New Project。输入自己的项目名和文件存放位置，本项目采用的ArkTS语言进行开发。  
![图6-9 创建项目](/images/image.19.png "图6-9 创建项目")  

（2）真机签名  
为了进行程序在DAYU200上的调试与开发，首先需要进行真机签名，可以通过DevEco Studio来进行自动签名  
![图6-10 签名](/images/image.20.png "图6-10 签名")  

（3）代码开发  
App前端搭建：本项目实现的是前后端分离，其中前端开发环境为OpenHarmony3.2，项目致力于实现可视化OpenHarmony App。本团队以ArkTS为开发语言，利用OpenHarmony组件中的list-item，button，input，toolbar，tabs，element等组件搭建前端界面，使其可够实现页面跳转，滑动翻页，输入查询，点击查看等功能。实现了环境温度、湿度、风力以及太阳能的监测，并且可以实时获取发电量，电池电压、电流，实时监控电池的健康状况。

在开发的过程中遇到了很多问题，比如预览画面和真机调试画面无法弹性适配、颜色效果不一样、团队分工开发效率不高等问题，但经过队员的不断讨论与坚持不懈，这些问题最后都迎刃而解，最后我们将代码进行汇总，来实现完整的前端界面。  
![图6-11 部分代码展示](/images/image.21.png "图6-11 部分代码展示")  
![图6-12 部分代码展示](/images/image.22.png "图6-12 部分代码展示")  
![图6-13 部分代码展示](/images/image.23.png "图6-13 部分代码展示")  
![图6-14 部分代码展示](/images/image.24.png "图6-14 部分代码展示")  

# 七、功能介绍
## 7.1 登录注册
每个用户对应专属的电量预测和运维服务，用户在使用APP时首先进行登录注册，只有账号和密码和MySQL数据库相对应时，才可以进行登录。  
![图7-1 登录页面](/images/image.25.png "图7-1 登录页面")  
## 7.2 发电设备全生命周期监测
基于OpenHarmony打造智能运维系统，通过双向数字孪生对微电网进行全生命周期监测，实现能源数字化。  
![图7-2 设备管理](/images/image.26.png "图7-2 设备管理")  ![图7-2 设备管理](/images/image.26.2.png "图7-2 设备管理")  ![图7-2 设备管理](/images/image.26.3.png "图3-1 图7-2 设备管理")  
## 7.3 电量预测
基于深度学习构建电量预测模型，通过预测实时电量和长短期发电量为用户量身定制用电规划，减少能源损耗，提高发电效率，降低设备运维成本。  
![图7-3 电量预测](/images/image.27.1.png "图7-3 电量预测")  ![图7-3 电量预测](/images/image.27.2.png "图7-3 电量预测")  
## 7.4 用户用电行为分析
通过K-means聚类算法实现用户用电行为分析。收集用户的用电情况，通过大数据分析手段，及时、准确地掌握用户用电行为特征，并为用户进行等级划分，并根据不同等级来为用户提供不同的用电方案，实现电量的合理利用。  
![图7-4 页面设计](/images/image.28.png "图7-4 页面设计")  
# 八、应用场景
## 8.1 工业园区
我国工业园区的经济增长速率远高于国家平均水平，已成为国家重要的工业生产空间和布局方式。但工业园区工业生产集中，能源需求量大，污染物排放强度高，温室气体排放量大。近年来，工业园区始终是《大气污染防治行动计划》《水污染防治行动计划》等污染防治战略的重点治理对象。随着我国碳达峰和碳中和国家战略的提出，各部委陆续出台相应的政策和标准，推进园区绿色、低碳、循环发展。

但由于中国工业园区数量众多且园区内企业间、基础设施和园区间尚未完全形成产业共生网络、绿色供应链和自主可控的产业链，无法进行大风机和大光伏的安装。而我们采用规模大分散小、微主体聚合的新型智慧微电网概念，适用绝大多数场地。可根据企业规模大小，需要用电多少，进行量化规划，让规模与企业需求画上等号。
## 8.2 居民用户
2021年年底，国家能源局、农业农村部、国家乡村振兴局印发关于《加快农村能源转型发展助力乡村振兴的实施意见》的通知。明确提出支持县域清洁能源规模化开发，在具备资源条件的中西部脱贫地区，特别是乡村振兴重点帮扶县，优先规划建设集中式风电、光伏基地，为脱贫县打造支柱产业。

我国农村自然资源丰富，通过部署我们的发电设备，帮助用户实现电量自发自用，余量上网，农村家庭用户每年可以增收1000-2000元。
## 8.3 边防哨所
我国疆域辽阔，为了守护国土，会在远离电网的边远地区设立边防哨所。但许多边防哨所是驻守在高海拔的高原深处，社会依托条件差，有的偏远哨所距离最近的县城也有数百公里；加之哨所驻地环境恶劣，每年封山期长达半年之久，用上长明电一直是驻守前哨班官兵的热切期望。

我们的产品基于仿生技术实现高折叠比，完全折叠后仅2个28寸行李箱大小，设备运行噪音小于10dB，启动风速仅在3m/s，每天发电可在5kw/h。不仅可以满足官兵的日常用电需求，而且便于携带，可以部署在所有的边防哨所，为我国边防哨所带去长明电。
# 九、产品价值
（1）产品规模部署灵活+适用性强，为城市、农村、偏远地区等应用场景提供一站式电力供应服务。

（2）AI赋能用电规划，供用户合理利用，减少能源浪费。

（3）数字化、可视化运维系统实时监测发电设备的全生命周期，提高发电效率、降低运维成本。

（4）多能互补长时储能，采用氢能进行储存，解决常规电池失水掉电、原料不足、环境污染等问题。
